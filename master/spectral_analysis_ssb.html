<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html"><link rel="search" title="Search" href="search.html"><link rel="next" title="API Reference" href="reference.html"><link rel="prev" title="Spectral Analysis" href="spectral_analysis.html">

    <!-- Generated with Sphinx 8.1.3 and Furo 2025.09.25 -->
        <title>Windowing and Single Side Bins - Genalyzer v0.1.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Genalyzer v0.1.2 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <span class="sidebar-brand-text">Genalyzer v0.1.2 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="spectral_analysis.html">Spectral Analysis</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Windowing and Single Side Bins</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference_simplified.html">(Beta) Simplified API Reference</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="python/genalyzer.html">Python Bindings</a><input aria-label="Toggle navigation of Python Bindings" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="python/pygenalyzer.html">pygenalizer</a><input aria-label="Toggle navigation of pygenalizer" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="python/enumerations.html">Enumerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/fourier_analysis.html">Fourier Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/fourier_configuration.html">Fourier Analysis Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/fourier_transforms.html">Fourier Transforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/waveforms.html">Waveforms</a></li>
<li class="toctree-l3"><a class="reference internal" href="python/signal_processing.html">Signal Processing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="python/pygenalyzer.simplified.html">pygenalizer.simplified (Beta)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pytest/index.html">Pytest Integration</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/spectral_analysis_ssb.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="windowing-and-single-side-bins">
<h1>Windowing and Single Side Bins<a class="headerlink" href="#windowing-and-single-side-bins" title="Link to this heading">¶</a></h1>
<p>In this tutorial, we study a common scenario that arises when spectral analysis is compromised due to <em>leakage</em>. We will then look at two ways to address this problem: applying a non-rectangular window function before computing the FFT and appropriately configuring the number of <em>single side bins</em> within Genalyzer. The waveform we analyze will be a <code class="docutils literal notranslate"><span class="pre">375</span> <span class="pre">KHz</span></code> complex sinusoidal tone sampled at <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">MSPS</span></code>. The only impairment in this waveform will be quantization noise. At the end of this tutorial, the reader will have gained an understanding on how to select the number of <em>single side bins</em> for the signal <em>component</em> in a <em>test</em>, in order to compute performance metrics such as SFDR, FSNR, SNR, NSD etc. This tutorial follows the discussion on <a class="reference external" href="https://analogdevicesinc.github.io/genalyzer/master/spectral_analysis.html">spectral analysis</a>. So, please read that page first to become familiar with the workflow of Genalyzer.</p>
<p>To recap, we follow a three-stage workflow in Genalyzer as shown below.</p>
<pre  class="mermaid">
        graph LR;
    A[Generate/Import Waveform] --&gt; B[Compute FFT];
    B --&gt;C1[Configure Spectral Analysis];

    subgraph SA[Spectral Analysis]
      C1[Configure] --&gt;C2[Run];
    end

    style SA fill:#ffffff
    </pre><p>We will first generate the waveform to be analyzed, compute its FFT, and calculate various performance metrics by running spectral analysis. Please refer to the <a class="reference external" href="https://github.com/analogdevicesinc/genalyzer/blob/main/bindings/python/examples/gn_doc_spectral_analysis2.py">leakage and spectral-analysis example</a> Python script to follow the discussion on this page.</p>
<section id="leakage">
<h2>Leakage<a class="headerlink" href="#leakage" title="Link to this heading">¶</a></h2>
<pre  class="mermaid">
        graph LR;
    A[Generate/Import Waveform] --&gt; B[Compute FFT];
    B --&gt;C1[Configure Spectral Analysis];

    subgraph SA[Spectral Analysis]
      C1[Configure] --&gt;C2[Run];
    end

    style SA fill:#ffffff

    style A fill:#9fa4fc
    style B fill:#9fa4fc
    </pre><p>In the <a class="reference external" href="https://github.com/analogdevicesinc/genalyzer/blob/main/bindings/python/examples/gn_doc_spectral_analysis2.py">leakage and spectral-analysis example</a> Python script, we generate the complex-sinusoidal waveform as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># signal configuration</span>
<span class="n">npts</span> <span class="o">=</span> <span class="mi">30000</span> <span class="c1"># number of points in the signal</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mf">4e6</span> <span class="c1"># sample-rate of the data</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mi">375000</span> <span class="c1"># tone frequency</span>
<span class="n">phase</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># tone phase</span>
<span class="n">ampl_dbfs</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="c1"># amplitude of the tone in dBFS</span>
<span class="n">ampl</span> <span class="o">=</span> <span class="p">(</span><span class="n">fsr</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">ampl_dbfs</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)</span> <span class="c1"># amplitude of the tone in linear scale</span>

<span class="c1"># generate signal for analysis</span>
<span class="n">wf</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">ampl</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
<span class="n">awfq</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">ampl</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
<span class="n">qwfi</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">awfi</span><span class="p">,</span> <span class="n">fsr</span><span class="p">,</span> <span class="n">qres</span><span class="p">,</span> <span class="n">qnoise</span><span class="p">,</span> <span class="n">code_fmt</span><span class="p">)</span>
<span class="n">qwfq</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">awfq</span><span class="p">,</span> <span class="n">fsr</span><span class="p">,</span> <span class="n">qres</span><span class="p">,</span> <span class="n">qnoise</span><span class="p">,</span> <span class="n">code_fmt</span><span class="p">)</span>
</pre></div>
</div>
<p>A time-domain plot of the complex-sinusoidal tone is shown below for reference.</p>
<figure class="align-default" id="id1">
<img alt="_images/complex_sinusoidal_waveform2.png" src="_images/complex_sinusoidal_waveform2.png" />
<figcaption>
<p><span class="caption-text">Time-domain plot of a <code class="docutils literal notranslate"><span class="pre">375</span> <span class="pre">KHz</span></code> complex sinusoidal tone sampled at <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">MSPS</span></code>.</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>As shown in this plot, the snapshot of the signal is aperiodic and data is sampled over an incomplete period at the end. This discontinuity causes <em>leakage</em> resulting in a smearing effect that spreads the energy of the <code class="docutils literal notranslate"><span class="pre">375</span> <span class="pre">KHz</span></code> tone over a wider frequency range, with the appearance of frequency components that are not present in the original signal. This is readily seen in the FFT plot below.</p>
<figure class="align-default" id="id2">
<img alt="_images/fft2.png" src="_images/fft2.png" />
<figcaption>
<p><span class="caption-text">FFT plot of a <code class="docutils literal notranslate"><span class="pre">375</span> <span class="pre">KHz</span></code> complex sinusoidal tone sampled at <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">MSPS</span></code>.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<section id="windowing-to-reduce-leakage">
<h3>Windowing To Reduce Leakage<a class="headerlink" href="#windowing-to-reduce-leakage" title="Link to this heading">¶</a></h3>
<p>Note that in the above plot, the FFT of the time-domain waveform was computed as is with the underlying assumption that the waveform is periodic. In practice, as discussed above, this assumption is generally invalid and the snapshot of a waveform contains incomplete periods rendering the signal aperiodic. To overcome this limitation, a window function is applied to reduce leakage. In the <a class="reference external" href="https://github.com/analogdevicesinc/genalyzer/blob/main/bindings/python/examples/gn_doc_spectral_analysis2.py">leakage and spectral-analysis example</a> Python script, we used Blackman-Harris window as shown in the snippet below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># signal configuration</span>
<span class="n">npts</span> <span class="o">=</span> <span class="mi">30000</span> <span class="c1"># number of points in the signal</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mf">4e6</span> <span class="c1"># sample-rate of the data</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mi">375000</span> <span class="c1"># tone frequency</span>
<span class="n">phase</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># tone phase</span>
<span class="n">ampl_dbfs</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="c1"># amplitude of the tone in dBFS</span>
<span class="n">qnoise_dbfs</span> <span class="o">=</span> <span class="o">-</span><span class="mf">60.0</span>  <span class="c1"># quantizer noise in dBFS</span>
<span class="n">fsr</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="c1"># full-scale range of I/Q components of the complex tone</span>
<span class="n">ampl</span> <span class="o">=</span> <span class="p">(</span><span class="n">fsr</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">ampl_dbfs</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)</span> <span class="c1"># amplitude of the tone in linear scale</span>
<span class="n">qnoise</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">qnoise_dbfs</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)</span> <span class="c1"># quantizer noise in linear scale</span>
<span class="n">qres</span> <span class="o">=</span> <span class="mi">12</span>  <span class="c1"># data resolution</span>
<span class="n">code_fmt</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">CodeFormat</span><span class="o">.</span><span class="n">TWOS_COMPLEMENT</span> <span class="c1"># integer data format</span>

<span class="c1"># FFT configuration</span>
<span class="n">navg</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># number of FFT averages</span>
<span class="n">nfft</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">npts</span><span class="o">/</span><span class="n">navg</span><span class="p">)</span> <span class="c1"># FFT-order</span>
<span class="n">window</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">Window</span><span class="o">.</span><span class="n">BLACKMAN_HARRIS</span> <span class="c1"># window function to apply</span>
<span class="n">axis_type</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">FreqAxisType</span><span class="o">.</span><span class="n">DC_CENTER</span> <span class="c1"># axis type</span>

<span class="c1"># generate signal for analysis</span>
<span class="n">awfi</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">ampl</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
<span class="n">awfq</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">ampl</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>
<span class="n">qwfi</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">awfi</span><span class="p">,</span> <span class="n">fsr</span><span class="p">,</span> <span class="n">qres</span><span class="p">,</span> <span class="n">qnoise</span><span class="p">,</span> <span class="n">code_fmt</span><span class="p">)</span>
<span class="n">qwfq</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">quantize</span><span class="p">(</span><span class="n">awfq</span><span class="p">,</span> <span class="n">fsr</span><span class="p">,</span> <span class="n">qres</span><span class="p">,</span> <span class="n">qnoise</span><span class="p">,</span> <span class="n">code_fmt</span><span class="p">)</span>

<span class="c1"># compute FFT</span>
<span class="n">fft_cplx</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">qwfi</span><span class="p">,</span> <span class="n">qwfq</span><span class="p">,</span> <span class="n">qres</span><span class="p">,</span> <span class="n">navg</span><span class="p">,</span> <span class="n">nfft</span><span class="p">,</span> <span class="n">window</span><span class="p">,</span> <span class="n">code_fmt</span><span class="p">)</span>
</pre></div>
</div>
<p>A window function shapes the time-domain waveform such that the first and last samples are exactly zero, and the samples in between are multiplied according to a mathematical function that is symmetric around the center and tapers off away from the center. As a result, an aperiodic waveform is forced to be periodic. The FFT plot of the windowed waveform below shows that leakage has been minimized and a peak where the tone is expected is seen more clearly than with a rectangular window.</p>
<figure class="align-default" id="id3">
<img alt="_images/fft3.png" src="_images/fft3.png" />
<figcaption>
<p><span class="caption-text">FFT plot of a <code class="docutils literal notranslate"><span class="pre">375</span> <span class="pre">KHz</span></code> complex sinusoidal tone sampled at <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">MSPS</span></code>.</span><a class="headerlink" href="#id3" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When computing the FFT of a waveform to which a window function has been applied, a weighting factor must also be taken into account so that the correct FFT signal amplitude level is recovered after the windowing. Genalyzer takes this effect into account.</p>
</div>
</section>
</section>
<section id="spectral-analysis">
<h2>Spectral Analysis<a class="headerlink" href="#spectral-analysis" title="Link to this heading">¶</a></h2>
<section id="configure-single-side-bins">
<h3>Configure Single Side Bins<a class="headerlink" href="#configure-single-side-bins" title="Link to this heading">¶</a></h3>
<pre  class="mermaid">
        graph LR;
    A[Generate/Import Waveform] --&gt; B[Compute FFT];
    B --&gt;C1[Configure Spectral Analysis];

    subgraph SA[Spectral Analysis]
      C1[Configure] --&gt;C2[Run];
    end

  style C1 fill:#9fa4fc
  style SA fill:#ffffff
    </pre><p>Even though leakage has been minimized, the tone is not as sharp as when the snapshot of the waveform were periodic. This can be observed by zooming into the region around the <code class="docutils literal notranslate"><span class="pre">375</span> <span class="pre">KHz</span></code> tone. This is shown in the plot below.</p>
<figure class="align-default" id="id4">
<img alt="_images/fft4.png" src="_images/fft4.png" />
<figcaption>
<p><span class="caption-text">Zoomed-in FFT plot of a <code class="docutils literal notranslate"><span class="pre">375</span> <span class="pre">KHz</span></code> complex sinusoidal tone sampled at <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">MSPS</span></code>.</span><a class="headerlink" href="#id4" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Another key point to note is that there is no bin that corresponds to <code class="docutils literal notranslate"><span class="pre">375</span> <span class="pre">KHz</span></code> due to the settings we chose in this working example. To go into more detail, the width of each bin in our working example is <code class="docutils literal notranslate"><span class="pre">fs/npts</span> <span class="pre">=</span> <span class="pre">133.33</span> <span class="pre">Hz</span></code>, which is not an integer divider of <code class="docutils literal notranslate"><span class="pre">375</span> <span class="pre">KHz</span></code>. Hence the energy of the tone is spread over <code class="docutils literal notranslate"><span class="pre">12</span></code> neighboring bins, approximately. Users need to configure Genalyzer by providing the number of these bins that need to be taken into account when conducting spectral analysis.</p>
<p>In a similar manner, we can see by zooming around the DC component that its energy is spread over <code class="docutils literal notranslate"><span class="pre">7</span></code> bins, approximately. This can be seen in the figure below.</p>
<figure class="align-default" id="id5">
<img alt="_images/fft4_dc.png" src="_images/fft4_dc.png" />
<figcaption>
<p><span class="caption-text">Zoomed-in FFT plot of DC component for the working example.</span><a class="headerlink" href="#id5" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>Consequently, we configure the DC component also to consider more than one bin in calculating the performance metrics.</p>
<p>In <a class="reference external" href="https://github.com/analogdevicesinc/genalyzer/blob/main/bindings/python/examples/gn_doc_spectral_analysis2.py">leakage and spectral-analysis example</a> Python script, it is done by the following lines of code, where a <em>test</em> if created first followed by associating various <em>components</em> to this <em>test</em>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fourier analysis configuration</span>
<span class="n">test_label</span> <span class="o">=</span> <span class="s2">&quot;fa&quot;</span>
<span class="n">gn</span><span class="o">.</span><span class="n">fa_create</span><span class="p">(</span><span class="n">test_label</span><span class="p">)</span>

<span class="n">signal_component_label</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
<span class="n">ssb_fund</span> <span class="o">=</span> <span class="mi">6</span> <span class="c1"># number of single-side bins for the signal component</span>
<span class="n">ssb_dc</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># number of single-side bins for the DC-component</span>
<span class="n">gn</span><span class="o">.</span><span class="n">fa_max_tone</span><span class="p">(</span><span class="n">test_label</span><span class="p">,</span> <span class="n">signal_component_label</span><span class="p">,</span> <span class="n">gn</span><span class="o">.</span><span class="n">FaCompTag</span><span class="o">.</span><span class="n">SIGNAL</span><span class="p">,</span> <span class="n">ssb_fund</span><span class="p">)</span>
<span class="n">gn</span><span class="o">.</span><span class="n">fa_ssb</span><span class="p">(</span><span class="n">test_label</span><span class="p">,</span> <span class="n">gn</span><span class="o">.</span><span class="n">FaSsb</span><span class="o">.</span><span class="n">DC</span><span class="p">,</span> <span class="n">ssb_dc</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that, we set <code class="docutils literal notranslate"><span class="pre">ssb_fund</span></code> to <code class="docutils literal notranslate"><span class="pre">6</span></code> and <code class="docutils literal notranslate"><span class="pre">ssb_dc</span></code> to <code class="docutils literal notranslate"><span class="pre">3</span></code>. These choices are based on the plots above where we determined that <code class="docutils literal notranslate"><span class="pre">12</span></code> bins in the neighborhood of the <code class="docutils literal notranslate"><span class="pre">375</span> <span class="pre">KHz</span></code> tone contain all the energy of the signal tone and <code class="docutils literal notranslate"><span class="pre">7</span></code> bins around DC contain the energy of the DC-component.</p>
</section>
<section id="run">
<h3>Run<a class="headerlink" href="#run" title="Link to this heading">¶</a></h3>
<pre  class="mermaid">
        graph LR;
    A[Generate/Import Waveform] --&gt; B[Compute FFT];
    B --&gt;C1[Configure Spectral Analysis];

    subgraph SA[Spectral Analysis]
      C1[Configure] --&gt;C2[Run];
    end

  style C2 fill:#9fa4fc
  style SA fill:#ffffff
    </pre><p>Next, we run FFT analysis in the <a class="reference external" href="https://github.com/analogdevicesinc/genalyzer/blob/main/bindings/python/examples/gn_doc_spectral_analysis2.py">leakage and spectral-analysis example</a> Python script as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fourier analysis execution</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">gn</span><span class="o">.</span><span class="n">fft_analysis</span><span class="p">(</span><span class="n">test_label</span><span class="p">,</span> <span class="n">fft_cplx</span><span class="p">,</span> <span class="n">nfft</span><span class="p">,</span> <span class="n">axis_type</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting magnitude spectrum plot for the working example considered so far, with DC, signal, and harmonic components labeled, is shown below.</p>
<figure class="align-default" id="id6">
<img alt="_images/spectral_analysis_summary3.png" src="_images/spectral_analysis_summary3.png" />
<figcaption>
<p><span class="caption-text">Magnitude spectrum of the FFT showing signal, harmonic, DC, and WO components.</span><a class="headerlink" href="#id6" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="reference.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">API Reference</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="spectral_analysis.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Spectral Analysis</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024-2025, Analog Devices, Inc.
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Windowing and Single Side Bins</a><ul>
<li><a class="reference internal" href="#leakage">Leakage</a><ul>
<li><a class="reference internal" href="#windowing-to-reduce-leakage">Windowing To Reduce Leakage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#spectral-analysis">Spectral Analysis</a><ul>
<li><a class="reference internal" href="#configure-single-side-bins">Configure Single Side Bins</a></li>
<li><a class="reference internal" href="#run">Run</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=69c7a37b"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="_static/tabs.js?v=3ee01567"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script type="module">
import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";
window.addEventListener("load", () => mermaid.run());
</script>
    </body>
</html>